!function(){"use strict";var e,t={870:function(e,t,n){var s=window.wp.apiFetch,r=n.n(s),a=(window.wp.domReady,window.wp.element),l=window.wp.components;function c(e){let{currentProgress:t,isInProgress:n,posts:s,setIsInProgress:c,setCurrentProgress:o,setPosts:u}=e;const[i,d]=(0,a.useState)({current:0,limit:10,total:s.is_duplicate.max_num_pages,force_delete:!1}),[p,m]=(0,a.useState)(0),[f,g]=(0,a.useState)(0),[h,E]=(0,a.useState)(!1),v=(0,a.useCallback)((async()=>{await r()({path:"/bca/delete-duplicates/v1/delete?"+p.toString()}).then((e=>{if(e.error)return;let{current:t,limit:n}=e,s=t/i.total*100,r=t+1,a=f+e.posts.length;d({current:r,limit:n,total:i.total,force_delete:!1}),g(a),o(s)}))}));return(0,a.useEffect)((()=>{0!=p&&v()}),[p]),(0,a.useEffect)((()=>{setTimeout((()=>{}),2e3)}),[h]),(0,a.useEffect)((()=>{n&&null!=t&&(console.log(t),((e,t,n)=>{if(0==n)return void E(!0);if(e>n)return void E(!0);e<1?e=1:e>n&&(e=n);let s=new URLSearchParams({current:e,limit:t,total:n,force_delete:!1});m(s)})(i.current,i.limit,i.total))}),[n,t]),h?(0,a.createElement)(l.Notice,{status:"success",isDismissible:!1},(0,a.createElement)("p",null,"Process is complete. ",(0,a.createElement)("strong",null,f)," duplicated posts have been deleted.")):(0,a.createElement)("div",null,(0,a.createElement)(l.Button,{id:"start-deletion",variant:n?"secondary":"primary",isBusy:n,isSmall:!0,isDestructive:!0,disabled:n,onClick:()=>{c(!0),o(0)}},n?"Deleting Duplicates...":"Delete Duplicates"),i.current>0&&(0,a.createElement)("small",null,"Deleted ",f," duplicated posts"))}function o(e){let{value:t}=e;return(0,a.createElement)("div",{className:"bca-progress-container"},(0,a.createElement)("div",{className:"bca-progress"},(0,a.createElement)("progress",{value:t,max:"100"}," ",t," ")))}function u(e){let{title:t}=e;const n=document.location.origin;return(0,a.createElement)(l.Card,null,(0,a.createElement)(l.CardHeader,null,(0,a.createElement)("h2",null,t),(0,a.createElement)(l.Button,{disabled:!0,__experimentalIsFocusable:!0},n)))}function i(e){let{posts:t,currentProgress:n,isInProgress:s,setIsInProgress:r,setCurrentProgress:u,setPosts:i}=e;return(0,a.createElement)(l.Card,{className:"bca-duplicate-posts-main"},(0,a.createElement)(l.CardBody,{className:"bca-duplicate-posts-content"},(0,a.createElement)("h2",null,"Summary"),(0,a.createElement)("p",null,"We found ",(0,a.createElement)("strong",null,t.has_duplicate.found_posts)," posts that have been duplicated."),(0,a.createElement)("p",null,"Total number of duplicate posts: ",(0,a.createElement)("strong",null,t.is_duplicate.found_posts),"."),t.has_duplicate.found_posts>0&&(0,a.createElement)(c,{currentProgress:n,isInProgress:s,posts:t,setIsInProgress:r,setCurrentProgress:u,setPosts:i}),s&&(0,a.createElement)(o,{value:n})))}function d(e){let{isSearching:t,setIsSearching:n,setPosts:s}=e;const[c,u]=(0,a.useState)(0),[i,d]=(0,a.useState)(1),[p,m]=(0,a.useState)(!1),[f,g]=(0,a.useState)(0),h=(0,a.useCallback)((async()=>{await r()({path:"/bca/delete-duplicates/v1/search?page="+c}).then((e=>{console.log(e);let t=c/e.max_num_pages*100;return e.max_num_pages<=c&&0==e.wp_cache_set?(s(e),void n(!1)):e.wp_cache_set?(d(1),u(0),g(e.found_posts),void h()):(d(t),void u(c+1))}))}));return(0,a.useEffect)((()=>{t&&h()}),[t,c]),(0,a.createElement)(l.Card,{className:"bca-duplicate-posts-new-search"},(0,a.createElement)(l.CardBody,null,(0,a.createElement)("h3",null,"Search your site to find duplicate content."),(0,a.createElement)(l.Button,{isBusy:t,disabled:t,id:"start-search",onClick:()=>n(!0)},t?0==f?"Searching...":"Tagging...":"Search Site"),t&&0==f?(0,a.createElement)("p",null,"Please wait, currently searching your database..."):"",t&&f>0?(0,a.createElement)("p",null,"Found ",(0,a.createElement)("strong",null,f)," posts that have been duplicated. Please wait, currently tagging duplicated posts..."):"",t&&f>0&&(0,a.createElement)(o,{value:i})))}window.wp.data;(0,a.render)((0,a.createElement)((function(e){const[t,n]=(0,a.useState)(!1),[s,l]=(0,a.useState)(!1),[c,o]=(0,a.useState)(!0),[p,m]=(0,a.useState)(null),[f,g]=(0,a.useState)([]);return(0,a.useEffect)((()=>{r()({path:"/bca/delete-duplicates/v1/duplicates"}).then((e=>{0!=e.length&&(o(!1),g(e))}))}),[]),console.log(f),(0,a.createElement)("div",{className:"bca-delete-duplicate-posts"},0==f.has_duplicate||0==f.length?(0,a.createElement)(a.Fragment,null,(0,a.createElement)(u,{title:"Delete Duplicate Posts"}),(0,a.createElement)(d,{isSearching:t,setIsSearching:n,setPosts:g})):(0,a.createElement)(a.Fragment,null,(0,a.createElement)(u,{title:"Delete Duplicate Posts"}),(0,a.createElement)(i,{currentProgress:p,isInProgress:s,posts:f,setCurrentProgress:m,setIsInProgress:l,setPosts:g})))}),null),document.getElementById("bca-root"))}},n={};function s(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,s),a.exports}s.m=t,e=[],s.O=function(t,n,r,a){if(!n){var l=1/0;for(i=0;i<e.length;i++){n=e[i][0],r=e[i][1],a=e[i][2];for(var c=!0,o=0;o<n.length;o++)(!1&a||l>=a)&&Object.keys(s.O).every((function(e){return s.O[e](n[o])}))?n.splice(o--,1):(c=!1,a<l&&(l=a));if(c){e.splice(i--,1);var u=r();void 0!==u&&(t=u)}}return t}a=a||0;for(var i=e.length;i>0&&e[i-1][2]>a;i--)e[i]=e[i-1];e[i]=[n,r,a]},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,l=n[0],c=n[1],o=n[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(r in c)s.o(c,r)&&(s.m[r]=c[r]);if(o)var i=o(s)}for(t&&t(n);u<l.length;u++)a=l[u],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(i)},n=self.webpackChunkwp_delete_duplicate_post=self.webpackChunkwp_delete_duplicate_post||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=s.O(void 0,[431],(function(){return s(870)}));r=s.O(r)}();