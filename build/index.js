!function(){"use strict";var e,t={250:function(e,t,n){var r=window.wp.element,s=window.wp.apiFetch,a=n.n(s),l=window.wp.components;function c(e){let{currentProgress:t,isInProgress:n,posts:s,setIsInProgress:c,setCurrentProgress:u,setPosts:o}=e;const[i,d]=(0,r.useState)({current:0,limit:10,total:s.is_duplicate.max_num_pages,force_delete:!1}),[p,m]=(0,r.useState)(0),[f,g]=(0,r.useState)(0),[h,E]=(0,r.useState)(!1),v=(0,r.useCallback)((async()=>{await a()({path:"/bca/delete-duplicates/v1/delete?"+p.toString()}).then((e=>{if(e.error)return;let{current:t,limit:n}=e,r=t/i.total*100,s=t+1,a=f+e.posts.length;d({current:s,limit:n,total:i.total,force_delete:!1}),g(a),u(r)}))}));return(0,r.useEffect)((()=>{0!=p&&v()}),[p]),(0,r.useEffect)((()=>{setTimeout((()=>{}),2e3)}),[h]),(0,r.useEffect)((()=>{n&&null!=t&&(console.log(t),((e,t,n)=>{if(0==n)return void E(!0);if(e>n)return void E(!0);e<1?e=1:e>n&&(e=n);let r=new URLSearchParams({current:e,limit:t,total:n,force_delete:!1});m(r)})(i.current,i.limit,i.total))}),[n,t]),h?(0,r.createElement)(l.Notice,{status:"success",isDismissible:!1},(0,r.createElement)("p",null,"Process is complete. ",(0,r.createElement)("strong",null,f)," duplicated posts have been deleted.")):(0,r.createElement)("div",null,(0,r.createElement)(l.Button,{id:"start-deletion",variant:n?"secondary":"primary",isBusy:n,isSmall:!0,isDestructive:!0,disabled:n,onClick:()=>{c(!0),u(0)}},n?"Deleting Duplicates...":"Delete Duplicates"),i.current>0&&(0,r.createElement)("small",null,"Deleted ",f," duplicated posts"))}function u(e){let{value:t}=e;return(0,r.createElement)("div",{className:"bca-progress-container"},(0,r.createElement)("div",{className:"bca-progress"},(0,r.createElement)("progress",{value:t,max:"100"}," ",t," ")))}function o(e){let{title:t}=e;const n=document.location.origin;return(0,r.createElement)(l.Card,null,(0,r.createElement)(l.CardHeader,null,(0,r.createElement)("h2",null,t),(0,r.createElement)(l.Button,{disabled:!0,__experimentalIsFocusable:!0},n)))}function i(e){let{posts:t,currentProgress:n,isInProgress:s,setIsInProgress:a,setCurrentProgress:o,setPosts:i}=e;return(0,r.createElement)(l.Card,{className:"bca-duplicate-posts-main"},(0,r.createElement)(l.CardBody,{className:"bca-duplicate-posts-content"},(0,r.createElement)("h2",null,"Summary"),(0,r.createElement)("p",null,"We found ",(0,r.createElement)("strong",null,t.has_duplicate.found_posts)," posts that have been duplicated."),(0,r.createElement)("p",null,"Total number of duplicate posts: ",(0,r.createElement)("strong",null,t.is_duplicate.found_posts),"."),t.has_duplicate.found_posts>0&&(0,r.createElement)(c,{currentProgress:n,isInProgress:s,posts:t,setIsInProgress:a,setCurrentProgress:o,setPosts:i}),s&&(0,r.createElement)(u,{value:n})))}function d(e){let{isSearching:t,setIsSearching:n,setPosts:s}=e;const[c,o]=(0,r.useState)(0),[i,d]=(0,r.useState)(1),[p,m]=(0,r.useState)(!1),[f,g]=(0,r.useState)(0),h=(0,r.useCallback)((async()=>{await a()({path:"/bca/delete-duplicates/v1/search?page="+c}).then((e=>{console.log(e);let t=c/e.max_num_pages*100;return e.max_num_pages<=c&&0==e.wp_cache_set?(s(e),void n(!1)):e.wp_cache_set?(d(1),o(0),g(e.found_posts),void h()):(d(t),void o(c+1))}))}));return(0,r.useEffect)((()=>{t&&h()}),[t,c]),(0,r.createElement)(l.Card,{className:"bca-duplicate-posts-new-search"},(0,r.createElement)(l.CardBody,null,(0,r.createElement)("h3",null,"Search your site to find duplicate content."),(0,r.createElement)(l.Button,{isBusy:t,disabled:t,id:"start-search",onClick:()=>n(!0)},t?0==f?"Searching...":"Tagging...":"Search Site"),t&&0==f?(0,r.createElement)("p",null,"Please wait, currently searching your database..."):"",t&&f>0?(0,r.createElement)("p",null,"Found ",(0,r.createElement)("strong",null,f)," posts that have been duplicated. Please wait, currently tagging duplicated posts..."):"",t&&f>0&&(0,r.createElement)(u,{value:i})))}(0,r.render)((0,r.createElement)((function(e){const[t,n]=(0,r.useState)(!1),[s,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!0),[p,m]=(0,r.useState)(null),[f,g]=(0,r.useState)([]);return(0,r.useEffect)((()=>{a()({path:"/bca/delete-duplicates/v1/duplicates"}).then((e=>{0!=e.length&&(u(!1),g(e))}))}),[]),(0,r.createElement)("div",{className:"bca-delete-duplicate-posts"},0==f.has_duplicate||0==f.length?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o,{title:"Delete Duplicate Posts"}),(0,r.createElement)(d,{isSearching:t,setIsSearching:n,setPosts:g})):(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o,{title:"Delete Duplicate Posts"}),(0,r.createElement)(i,{currentProgress:p,isInProgress:s,posts:f,setCurrentProgress:m,setIsInProgress:l,setPosts:g})))}),null),document.getElementById("bca-root"))}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r.m=t,e=[],r.O=function(t,n,s,a){if(!n){var l=1/0;for(i=0;i<e.length;i++){n=e[i][0],s=e[i][1],a=e[i][2];for(var c=!0,u=0;u<n.length;u++)(!1&a||l>=a)&&Object.keys(r.O).every((function(e){return r.O[e](n[u])}))?n.splice(u--,1):(c=!1,a<l&&(l=a));if(c){e.splice(i--,1);var o=s();void 0!==o&&(t=o)}}return t}a=a||0;for(var i=e.length;i>0&&e[i-1][2]>a;i--)e[i]=e[i-1];e[i]=[n,s,a]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,a,l=n[0],c=n[1],u=n[2],o=0;if(l.some((function(t){return 0!==e[t]}))){for(s in c)r.o(c,s)&&(r.m[s]=c[s]);if(u)var i=u(r)}for(t&&t(n);o<l.length;o++)a=l[o],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(i)},n=self.webpackChunkwp_delete_duplicate_post=self.webpackChunkwp_delete_duplicate_post||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var s=r.O(void 0,[431],(function(){return r(250)}));s=r.O(s)}();